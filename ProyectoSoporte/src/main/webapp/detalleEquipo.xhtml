
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:p="http://primefaces.org/ui"
				xmlns:c="http://java.sun.com/jsp/jstl/core"
				template="plantilla/plantilla.xhtml">

	<ui:define name="cuerpo">

		<f:metadata>
			<f:viewParam name="numSerie" value="#{detalleEquipoBean.equipo.numSerie}" required="true"/>
			<f:event type="preRenderView" listener="#{detalleEquipoBean.cargarDetalleEquipo}"/>
		</f:metadata>

		<h1 style="text-align: center"> Detalle del equipo #{detalleEquipoBean.equipo.nombre}</h1>

		<div class="contenedorDetalle">

			<div id="Mensajes" class="mensajeDetalle">
				<p:messages id="mensajesError" closable="true" />
			</div>

			<div class="detalleDiv">

				<p:panelGrid styleClass="font panelInventario">

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Num de Serie:"/>
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.equipo.numSerie}"/>
						</p:column>
					</p:row>

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Procesador:"/>
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.equipo.procesador}"/>
						</p:column>
					</p:row>

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Memoria Ram:"/>
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.equipo.memoriaRam}"/>
						</p:column>
					</p:row>

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Disco Duro:"/>
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.equipo.discoDuro}"/>
						</p:column>
					</p:row>

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Sistema Operativo:"/>
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.equipo.sistOperativo}"/>
						</p:column>
					</p:row>

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Características:"/>
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.equipo.caracteristicas}" rendered="#{detalleEquipoBean.equipo.caracteristicas != null}"/>
							<h:outputText value="N/A" rendered="#{detalleEquipoBean.equipo.caracteristicas == null}" />
						</p:column>
					</p:row>

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Fecha de adquisición:"/>
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.equipo.fechaCompra}">
								<f:convertDateTime type="date" pattern="dd/MM/yyyy"/>
							</h:outputLabel>
						</p:column>
					</p:row>

				</p:panelGrid>

			</div>

			<div class="detalleDiv">
				<p:panelGrid styleClass="font panelInventario">

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Marca:"/>
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.equipo.modelo.marca.nombre}"/>
						</p:column>
					</p:row>

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Modelo:"/>
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.equipo.modelo.nombre}"/>
						</p:column>
					</p:row>

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Estado:" />
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.equipo.estado.nombre}"/>
						</p:column>
					</p:row>

					<p:row>
						<p:column styleClass="panelColumnaIzq">
							<h:outputLabel value="Usuario:" rendered="#{detalleEquipoBean.equipo.estado.nombre == 'Asignado'}"/>
						</p:column>
						<p:column styleClass="panelColumnaDer">
							<h:outputLabel value="#{detalleEquipoBean.usuario}" rendered="#{detalleEquipoBean.equipo.estado.nombre == 'Asignado'}"/>
						</p:column>
					</p:row>

				</p:panelGrid>

			</div>

			<div id="botonesGestion" class="detalleBotonesGestion">

				<p:panelGrid id="botones" styleClass="panelInventario botonesPanel" style="margin: 0 auto; font-size: small">
					<p:row>
						<p:column>
							<p:commandButton id="modificar" value="Modificar" immediate="true" action="#{detalleEquipoBean.bt_modificarEquipo}" update="mensajesError" >
								<f:param name="numSerie" value="#{detalleEquipoBean.equipo.numSerie}" />
							</p:commandButton>
						</p:column>
						<p:column>
							<p:commandButton id="cambiarEstado" value="Cambiar estado" immediate="true" action="#{detalleEquipoBean.bt_cambiarEstado}" update="mensajesError" />
						</p:column>
						<p:column>
							<p:commandButton id="eliminar" value="Eliminar" immediate="true" action="#{detalleEquipoBean.validarEstado}"
									   update="mensajesError dialogoEliminar" />
						</p:column>
					</p:row>
				</p:panelGrid>

			</div>

		</div>

		<div id="detalleDialogoEliminar">
			<p:dialog id="dialogoEliminar" header="Por favor ingrese" widgetVar="dialogoEliminar" closable="false" resizable="false" modal="true" >
				<h:form id="dialogo" >
					<p:messages id="mensajesDialog" for="observacion" closable="true" autoUpdate="true" />

					<p:panelGrid styleClass="panelInventario" >

						<p:row>
							<p:column styleClass="panelColumnaIzq">
								<p:outputLabel value="Incidencia:"/>
							</p:column>
							<p:column styleClass="panelColumnaDer">
								<p:inputText styleClass="anchoCompModificacion" value="#{detalleEquipoBean.incidencia}"
											 validatorMessage="En número de incidencia debe contener únicamente números y no sobrepasar los 7 caracteres">
									<f:validateRegex pattern="\d{1,7}"/>
								</p:inputText>
								<p:button icon="ui-icon-search" style="font-size: small" onclick=""/>
							</p:column>
						</p:row>

						<p:row>
							<p:column styleClass="panelColumnaIzq">
								<p:outputLabel value="Observación:"/>
							</p:column>
							<p:column styleClass="panelColumnaDer">
								<p:inputTextarea id="observacion" value="#{detalleEquipoBean.observacion}" rows="3" cols="22" autoResize="false"
												 counter="observ_caractEquipo" maxlength="100" counterTemplate="{0} caracteres restantes."
												 style="margin-right: 46px"
												 required="true" requiredMessage="Por favor indique el motivo de la modificacion"/>
								<p:outputLabel id="observ_caractEquipo" style="font-size: x-small"/>
								<p:outputLabel value="*" styleClass="requerido"/>
							</p:column>
						</p:row>

						<p:row>
							<p:column style="text-align: right; font-size: small">
								<p:commandButton value="Eliminar" action="#{detalleEquipoBean.bt_eliminarEquipo}" />
							</p:column>

							<p:column style="text-align: left; font-size: small">
								<p:commandButton value="Cancelar" immediate="true" onclick="PF('dialogoEliminar').hide()" />
							</p:column>
						</p:row>

					</p:panelGrid>

				</h:form>
			</p:dialog>
		</div>

		<div>
			<h:form id="datatable" >
				<p:dataTable id="Historial" var="item" value="#{detalleEquipoBean.historial}"
							 rows="15" paginator="true" rowsPerPageTemplate="10,15,25,50,100"
							 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							 widgetVar="itemTabla" emptyMessage="No se encontraron registros"
							 filteredValue="#{detalleEquipoBean.itemsBuscados}" tableStyle="table-layout: auto">

					<f:facet name="header">

						<p:panelGrid style="height: 30px" styleClass="panelInventario" >

							<p:row>
								<p:column>
									<p:outputLabel value="" style="font-size: medium; font-weight: bold;"/>
								</p:column>

								<p:column style="text-align: center">
									<p:outputLabel value="Historial" style="font-size: medium; font-weight: bold;"/>
								</p:column>
								<p:column>
									<p:inputText id="globalFilter" onkeyup="PF('itemTabla').filter()" style="width:150px; height: 30px; float: right;"/>
									<h:outputText value="Buscar: " style="float: right; font-size: small; display: inline; padding-top: 8px;"/>
								</p:column>
							</p:row>
						</p:panelGrid>

					</f:facet>

					<p:column headerText="Fecha" filterBy="#{item.fechaGestion}" filterStyle="display:none" >
						<h:outputText value="#{item.fechaGestion}">
						</h:outputText>
					</p:column>

					<p:column headerText="Tipo" filterBy="#{item.categoria.nombre}" filterStyle="display: none">
						<h:outputText value="#{item.categoria.nombre}"/>
					</p:column>

					<p:column headerText="Descripción" filterBy="#{item.descripcion}" filterStyle="display:none" >
						<h:outputText value="#{item.descripcion}"/>
					</p:column>

					<p:column headerText="Id incidencia" filterBy="#{item.idIncidencia}" filterStyle="display:none">
						<h:outputText value="#{item.idIncidencia}"/>
						<h:outputText value="N/A" rendered="#{item.idIncidencia == null}" />
					</p:column>

					<p:column headerText="Usuario" filterBy="#{item.usuarioAsignado}" filterStyle="display:none">
						<h:outputText value="#{item.usuarioAsignado}" rendered="#{item.usuarioAsignado != null}" />
						<h:outputText value="N/A" rendered="#{item.usuarioAsignado == null}" />
					</p:column>

					<p:column headerText="Responsable" filterBy="#{item.responsableSoporte}" filterStyle="display:none">
						<h:outputText value="#{item.responsableSoporte}" />
					</p:column>

				</p:dataTable>
			</h:form>
		</div>

	</ui:define>

</ui:composition>